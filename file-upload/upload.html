<script src="js/jquery-1.3.2.min.js" type="text/javascript"></script>
<script src="js/jquery.uploadify.v2.1.0.js" type="text/javascript"></script>
<script src="js/jquery.uploadify.v2.1.0.min.js" type="text/javascript"></script>
<script src="js/swfobject.js" type="text/javascript"></script>
<link href="css/uploadify.css" rel="stylesheet" type="text/css" />


<script type="text/javascript">
        $(document).ready(function () {
 
            $("#uploadify").uploadify({
                'uploader': 'image/uploadify.swf',  //uploadify.swf文件的相对路径，该swf文件是一个带有文字BROWSE的按钮，点击后淡出打开文件对话框              
             'script': 'Handler1.ashx',//    script ：  后台处理程序的相对路径
                'cancelImg': 'image/cancel.png',
                'buttenText': '请选择文件',//浏览按钮的文本，默认值：BROWSE。
                'sizeLimit':999999999,//文件大小显示
                'floder': 'Uploader',//上传文件存放的目录
              'queueID': 'fileQueue',//文件队列的ID，该ID与存放文件队列的div的ID一致
                'queueSizeLimit': 120,//上传文件个数限制
                'progressData': 'speed',//上传速度显示
                'auto': false,//是否自动上传
                'multi': true,//是否多文件上传
                //'onSelect': function (e, queueId, fileObj) {
                //    alert("唯一标识:" + queueId + "\r\n" +
                //  "文件名：" + fileObj.name + "\r\n" +
                //  "文件大小：" + fileObj.size + "\r\n" +
                //  "创建时间：" + fileObj.creationDate + "\r\n" +
                //  "最后修改时间：" + fileObj.modificationDate + "\r\n" +
                //  "文件类型：" + fileObj.type);
 
                //    }
                'onQueueComplete': function (queueData) {
                    alert("文件上传成功！");                  
                    return;
                }
 
            });
        });
		
		
		
		
		//参数
		$(document).ready(function() {  
			$('#fileInput1').fileUpload({  
					'uploader': 'uploader.swf',//不多讲了  
					'script': '/AjaxByJQuery/file.do',//处理Action  
					'cancelImg': 'cancel.png',          
					'folder': '',//服务端默认保存路径  
					'scriptData':{'methed':'uploadFile','arg1','value1'},  
					//向后台传递参数,methed,arg1为参数名,uploadFile,value1为对应的参数值,服务端通过request["arg1"]  
					'buttonText':'UpLoadFile',//按钮显示文字,不支持中文,解决方案见下  
					//'buttonImg':'图片路径',//通过设置背景图片解决中文问题,就是把背景图做成按钮的样子  
					'multi':'true',//多文件上传开关  
					 'fileExt':'*.xls;*.csv',//文件过滤器  
					'fileDesc':'.xls',//文件过滤器 详解见文档  
			   'onComplete' : function(event,queueID,file,serverData,data){   
							//serverData为服务器端返回的字符串值  
							alert(serverData);  
					 }  
			});  
		});  

</script>



<body>  
    <form id="form1" runat="server">  
    <div id="fileQueue">         
    </div>  
        <div>  
            <p>  
                <input type="file" name="uploadify" id="uploadify"/>  
                <input id="Button1" type="button" value="上传" onclick="javascript: $('#uploadify').uploadifyUpload()" />  
                <input id="Button2" type="button" value="取消" onclick="javascript:$('#uploadify').uploadifyClearQueue()" />  
            </p>  
        </div>  
    </form>  
</body>